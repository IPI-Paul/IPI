<html>
<head>
<title>IPI Media Search</title>
<meta name="GENERATOR" content="Microsoft Visual Studio 6.0" /><!-- CREATION DATE: 02/01/2006 -->
<meta content="IPI International, Microsoft, Text, Database, videos, Paul I Ighofose, Paul Ighofose, IPI, Ighofose, IP, music, media" 
name="Keywords" />
<meta content="Music Video Active Desktop Page by Paul I Ighofose - IPI International. Further Projects using text database." 
name="Description" />
<meta content="Paul I Ighofose - IPI International" name="Author" />
<meta content="all" name="Robots" />
<meta content="designs@ipi2internation.free-online.co.uk" name="Email" />
<meta content="Paul I Ighofose - IPI International" name="Copyright" />
<meta content="en" name="Language" />
<meta content="General" name="Rating" />
<meta content="Global" name="Distribution" />
<meta http-equiv="x-ua-compatible" content="IE=10">
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="pragma" content="no-cache" />
    <script type='text/javascript'>
        var au, ay, az, b, bc, DFl, dp, er, f, fc, flnms, fn, fp, fpl, fs, ft, m, n, o, ox, p1, p2, p3, pltb, PlLst, PlayLst, rl, rn, root, rp, rs, rt, s, sb, sf, tmpFl, tmpFl1, tmpFl2, tmpFl3, za, zb, zc, zd, ze, zf, zg, vm;
        function SchLd() {
            root = '';
            window.resizeTo(1240,710);
        }
        function TFl(a, b) {
            if(b == 1){
                tmpFl1 = a;
            }
            if(b == 2){
                tmpFl2 = a;
            }
            if(b == 3){
                tmpFl3 = a;
            }
        }
        function Actn(idx) {
            if (idx == 1) {
                PutInClipboard();
            }
            if (idx == 2) {
                GetPlayer();
            }
            if (idx > 0) {
                ActnTp.selectedIndex = 0;
            }
        }
        function txtSplit(txt) {
            return txt.split('"')[1];
        }
    </script>
    <script type='text/vbscript'>
        Function CrtdDb
            FlSch()
        End Function

        Function DrvCh()
            if instrRev(Drv.value,"/") > 0 then
                if right(Drv.value,1) <> "/" then Drv.value = Drv.value & "/"
            else
                if right(Drv.value,1) <> "\" then Drv.value = Drv.value & "\"
            end if
            if left(Drv.value,4) = "ftp:" or left(Drv.value,5) = "http:" then
                document.GetElementById("SrcRslt").outerHTML = "<IFRAME id=SrcRslt width=""100%"" height=400 src=""" & Drv.value &"""></IFRAME>"
                ft = "/"
            else
                FlSch()
            end if
        End Function

        Function DrvDb
            if left(Drv.value,4) = "ftp:" or left(Drv.value,5) = "http:" then
                document.GetElementById("SrcRslt").outerHTML = "<IFRAME id=SrcRslt width=""100%"" height=400 src=""" & Drv.value &"""></IFRAME>"
                ft = "/"
            else
                FlSch()
            end if
        End Function

        Function DrvPthCh
            if DrvPth.value = ".." then
                if instrRev(Drv.value,"\",len(Drv.value)-1) > 0 then
                    Drv.value = left(Drv.value,instrRev(Drv.value,"\",len(Drv.value)-1))
                elseif instrRev(Drv.value,"/",len(Drv.value)-1) > 0 then
                    Drv.value = left(Drv.value,instrRev(Drv.value,"/",len(Drv.value)-1))
                end if
            else
                Drv.value = DrvPth.value
            end if
            FlSch()
        End Function

        Function FlSch
            on error resume next
            if Left(Drv.value,2)="./" then
                ft = "/"
                Set f = fs.GetFolder(root & right(Drv.value,len(Drv.value)-2))
            else
                ft = "\"
                Set f = fs.GetFolder(Drv.value)
            end if
            Set sf = f.SubFolders
            Set fc = f.Files
            s = Drv.value
            tmpFl = ""
            tmpFl1 = ""
            tmpFl2 = ""
            tmpFl3 = ""
            document.GetElementById("SrcRslt").outerHTML = "<div id=SrcRslt style='width:98%;height:87%;position: absolute;overflow: scroll;'><table id='Ply' width='100%' style='font-size:0.75em;'></table></div>"
            ay = "<OPTION value='..'>..</OPTION>"
            ay = ay & "<OPTION value=""" & Drv.value & """ selected>" & Drv.value & "</OPTION>"
            For Each f1 In sf
                ay = ay & "<OPTION value=""" & s & f1.Name & ft & """>" & s & f1.Name & ft & "</OPTION>"
            next
            if Crtd.value>"" Then CDt = clng(cdate(Crtd.value))+1
            FlSch1 s,fc
            For Each f1 In sf
                if SbFld.checked = true then SbFlSch(s & f1.Name & ft)
            next
            DrvPth.outerHTML = "<SELECT id=DrvPth name=DrvPth onchange='DrvPthCh();'>" & ay & "</SELECT>"
            document.GetElementById("Ply").outerHTML = "<table id='Ply' width='100%' style='font-size:0.75em;'>" & tmpFl1 & tmpFl2 & tmpFl3 & tmpFl &"</table>"
        End Function

        Function FlSch1(fa,fb)
            i = 0
            For Each fd In fb
                i = i + 1
                if i = 2000 then
                    TFl tmpFl,1
                    tmpFl = ""
                elseif i = 4000 then
                    TFl tmpFl,2
                    tmpFl = ""
                elseif i = 6000 then
                    TFl tmpFl,3
                    tmpFl = ""
                end if
                if Crtd.value>"" Then CDt = clng(cdate(Crtd.value)) + 1
                if Crtd.value>"" and clng(fd.datecreated) = CDt or Crtd.value = "" then
                    if FlExt.value > "" then
                        ze = ucase(right(trim(fd.Name),3))
                    else
                        ze = ucase(FlExt.value)
                    end if
                    ok = 0
                    if left(FlNm.value,1) = "*" and right(FlNm.value,1) = "*" and ze = ucase(FlExt.value) then
                        if instr(1,ucase(fd.Name),ucase(right(left(FlNm.value,len(FlNm.value)-1),len(FlNm.value)-2))) > 0 then
                            ok = 1
                        end if
                    elseif left(FlNm.value,1) = "*" and ze = ucase(FlExt.value) then
                        if instrRev(fd.Name,".") > 0 then
                            d = ucase(right(left(fd.Name,len(fd.Name)-4),len(FlNm.value)-1))
                        else
                            d = ucase(right(fd.Name,len(FlNm.value)-1))
                        end if
                        if d >= ucase(right(FlNm.value,len(FlNm.value)-1)) and d <= ucase(right(FlNm.value,len(FlNm.value)-1) & ".z") then
                            ok = 1
                        end if
                    elseif right(FlNm.value,1) = "*" and ze = ucase(FlExt.value) then
                        d = ucase(left(fd.Name,len(FlNm.value)-1))
                        if d >= ucase(left(FlNm.value,len(FlNm.value)-1)) and d <= ucase(left(FlNm.value,len(FlNm.value)-1) & ".z") then
                            ok = 1
                        end if
                    elseif FlNm.value > "" and ze = ucase(FlExt.value) then
                        if ucase(fd.Name) >= ucase(FlNm.value) and ucase(fd.Name) <= ucase(FlNm.value & ".z") then
                            ok = 1
                        end if
                    elseif not SvTp.value = 1 then
                        ze = ucase(right(trim(fd.Name),3))
                        if SvTp.value = "2" then
                            Select Case ze
                                Case "MP3","CDA","WMA","WAV"
                                    ok = 1
                            End Select
                        elseif SvTp.value = "3" then
                            Select Case ze
                                Case "PNG","JPG","PCX","GIF","BMP"
                                    ok = 1
                            End Select
                        elseif SvTp.value = "4" then
                            Select Case ze
                                Case "AVI","PEG","DVX","DVD","FLV","MPG","MPE","ASF", "MP4"
                                    ok = 1
                            End Select
                        else
                            Select Case ze
                                Case ucase(SvTp.value)
                                    ok = 1
                            End Select
                        end if
                    elseif ze = ucase(FlExt.value) then
                        ok = 1
                    else
                    end if
                    if ok = 1 then 
                        tmpFl = tmpFl & "<tr><td>" & fd.Name & "</td></tr>"
                    end if
                end if
            Next
        End Function

        Function FsLd
            Set fs = CreateObject("Scripting.FileSystemObject")
        End Function

        Function GetPlayer
            'on error resume next
            msgbox "This is a very slow process and only worth it if the clipboard cannot cope with the copy function!" & vbcrlf & vbcrlf & "- Ensure that the Player is the only Microsoft Edge Tab open" & _
                    vbcrlf & "- Ensure that the Player Editor is currently displayed and that the cursor's last position was in the Editor Frame"
            devName = "."
            Set objWMIService = GetObject("winmgmts:\\" & devName & "\root\cimv2")
            sQry = "select * from Win32_Process where Name like 'MicrosoftEdgeCP%'"
            Set objItems = objWMIService.ExecQuery(sQry)
            Set myObj = CreateObject("Wscript.Shell")
            memId = 0
            For Each objItem in objItems
                'msgbox objItem.Name & vbcrlf & objItem.ProcessID & vbcrlf & objItem.WorkingSetSize & vbcrlf & objItem.CommandLine
                if memId < objItem.WorkingSetSize then 
                    memId = objItem.WorkingSetSize
                    procId = objItem.ProcessID
                end if
            Next
            myObj.AppActivate(procId)
            txt = " " & Ply.outerHTML
            txt = replace(replace(replace(replace(txt, "(", "{(}"), ")", "{)}"), "{", ""), "}", "")
            myObj.SendKeys txt, True
            set myObj = Nothing
            Set objWMIService = Nothing
            Set objItems = Nothing
        End Function

        Function PutInClipboard
            document.ParentWindow.ClipboardData.SetData "text", Ply.outerHTML
        End Function

        Function SbFlSch(a)
            Set f4 = fs.GetFolder(a)
            Set sf1 = f4.SubFolders
            Set fc1 = f4.Files
            For Each f5 In sf1
                ay = ay & "<OPTION value='" & a & f5.Name & ft & "'>" & a & f5.Name & ft & "</OPTION>"
                SbFlSch1(a & f5.Name & ft)
            next
            FlSch1 a,fc1
        End Function

        Function SbFlSch1(aa)
            Set f6 = fs.GetFolder(aa)
            Set sf2 = f6.SubFolders
            Set fc2 = f6.Files
            For Each f7 In sf2
                ay = ay & "<OPTION value='" & aa & f7.Name & ft & "'>" & aa & f7.Name & ft & "</OPTION>"
                SbFlSch1(aa & f7.Name & ft)
            next
            FlSch1 aa,fc2
        End Function

        Function SbFlSch2(ab)
            Set f8 = fs.GetFolder(ab)
            Set sf3 = f8.SubFolders
            Set fc3 = f8.Files
            For Each f9 In sf3
                ay = ay & "<OPTION value='" & ab & f9.Name & ft & "'>" & ab & f9.Name & ft & "</OPTION>"
            next
            FlSch1 ab,fc3
        End Function
    </script>
    <style>
        input, select {
	        border-width: 0px 0px 2px 0px;
        }
        table {
            height: 200;
        }
    </style>
</head>
<body onload="FsLd();SchLd();DrvDb();">
    <table>
        <tr>
            <td>
                <font size="-1">
                    File Name or First Few Letters
                </font>
                <input id="FlNm" name="FlNm" size="38" /><br />
            </td>
            <td>
                <font size="-1">
                    File Extension
                </font>
                <input id="FlExt" name="FlExt" size="2" />
            </td>
            <td>
                <select id="SvTp" name="SvTp" onchange="FlSch()">
                    <option value="1">All</option>
                    <option value="2">Music</option>
                    <option value="3">Picture</option>
                    <option value="4">Video</option>
                    <option value=".JS">.JS</option>
                    <option value="ASF">ASF</option>
                    <option value="AVI">AVI</option>
                    <option value="BAT">BAT</option>
                    <option value="BMP">BMP</option>
                    <option value="CDA">CDA</option>
                    <option value="CSV">CSV</option>
                    <option value="DOC">DOC</option>
                    <option value="DVD">DVD</option>
                    <option value="DVX">DVX</option>
                    <option value="FLV">FLV</option>
                    <option value="GIF">GIF</option>
                    <option value="ICO">ICO</option>
                    <option value="INF">INF</option>
                    <option value="INI">INI</option>
                    <option value="JPG">JPG</option>
                    <option value="LOG">LOG</option>
                    <option value="MDI">MDI</option>
                    <option value="MP3">MP3</option>
                    <option value="MP4">MP4</option>
                    <option value="MPE">MPE</option>
                    <option value="MPG">MPG</option>
                    <option value="MPV">MPV</option>
                    <option value="PCX">PCX</option>
                    <option value="PEG">PEG</option>
                    <option value="PNG">PNG</option>
                    <option value="PPT">PPT</option>
                    <option value="RTF">RTF</option>
                    <option value="SYS">SYS</option>
                    <option value="SWF">SWF</option>
                    <option value="TIF">TIF</option>
                    <option value="TXT">TXT</option>
                    <option value="VBS">VBS</option>
                    <option value="WAV">WAV</option>
                    <option value="WMA">WMA</option>
                    <option value="WMV">WMV</option>
                    <option value="XLS">XLS</option>
                    <option value="XLT">XLT</option>
                </select>
            </td>
            <td></td>
            <td>
                <font size="-1">
                    Created 
                </font>
                <input id="Crtd" name="Crtd" size="7" value="" onchange="CrtdDb();" ondblclick="CrtdDb();" />
            </td>
            <td>
                <input size="1" id="SbFld" name="SbFld" type="checkbox" />
                <font size="-1">
                    Search Subfolders 
                </font>
            </td>
            <td></td>
            <td>
                <select id="ActnTp" name="ActnTp" onchange="Actn(value)">
                    <option value="0">Select an Action</option>
                    <option value="1">Copy Table</option>
                    <option value="2">Send Table to Edge Editor Frame</option>
                </select>
            </td>
        </tr>
        <tr id="DrvRw">
            <td>
                <input id="Drv" name="Drv" size="90" value="C:\" ondblclick="DrvDb();" onchange="DrvCh();" title="DoubleClick to redisplay search results!" />
            </td>
        </tr>
        <tr>
            <td>
                <select id="DrvPth" name="DrvPth" onchange="DrvPthCh();"><option value="C:\">C:\</option></select>
            </td>
        </tr>
    </table>
    <iframe id="SrcRslt" width="100%" height="400" src=""></iframe>
</body>
</html>
